(function(e,r,l){function n(){console.log("[调试] Config.js生效");return true}function t(e,r,l){l=typeof l!=="undefined"?l:false;c(function(l){if(l==null){r(null);return}var n=false;$.each(l,function(l,t){if(t.id==e){n=true;r(t);return}});if(!n){r(null)}},l)}function u(e,r,l){l=typeof l!=="undefined"?l:false;c(function(l){if(l==null){r(null);return}var n=false;$.each(l,function(l,t){if(t.url_regex==e){n=true;r(t);return}});if(!n){r(null)}},l)}function c(e,r){r=typeof r!=="undefined"?r:false;if(r){chrome.storage.sync.get(["crawler_rules"],function(r){if(l==r.crawler_rules||r.crawler_rules.length==0){e(null)}else{e(r.crawler_rules)}})}else{chrome.storage.local.get(["crawler_rules"],function(r){if(l==r.crawler_rules||r.crawler_rules.length==0){e(null)}else{e(r.crawler_rules)}})}}function o(e,r){r=typeof r!=="undefined"?r:false;if(r){chrome.storage.sync.get(["crawler_rules"],function(r){if(l==r.crawler_rules||r.crawler_rules.length==0){e(0)}else{e(r.crawler_rules.length)}})}else{chrome.storage.local.get(["crawler_rules"],function(r){if(l==r.crawler_rules||r.crawler_rules.length==0){e(0)}else{e(r.crawler_rules.length)}})}}function a(e,r,l){l=typeof l!=="undefined"?l:false;c(function(n){if(n==null){n=[]}n.push(e);if(l){chrome.storage.sync.set({crawler_rules:n},function(){r(true)})}else{chrome.storage.local.set({crawler_rules:n},function(){r(true)})}},l)}function f(e,r,l){l=typeof l!=="undefined"?l:false;c(function(n){if(n==null){console.log("获取全部抓取规则为空");r(false);return}var t=-1;$.each(n,function(r,l){if(l.id==e.id){t=r}});if(t==-1){console.log("找不到要更新的抓取规则");r(false);return}n[t]=e;if(l){chrome.storage.sync.set({crawler_rules:n},function(){r(true)})}else{chrome.storage.local.set({crawler_rules:n},function(){r(true)})}},l)}function s(e,r,l){l=typeof l!=="undefined"?l:false;c(function(n){var t=-1;$.each(n,function(r,l){if(l.id==e){t=r}});if(t==-1){console.log("找不到要删除的抓取规则");r(false);return}var u=n.splice(t,1);console.log("要删除的抓取项为",u);if(l){chrome.storage.sync.set({crawler_rules:n},function(){r(true)})}else{chrome.storage.local.set({crawler_rules:n},function(){r(true)})}})}function i(e,r){r=typeof r!=="undefined"?r:false;if(r){chrome.storage.sync.remove("crawler_rules",function(){e(true)})}else{chrome.storage.local.remove("crawler_rules",function(){e(true)})}}function _(e,r){r=typeof r!=="undefined"?r:false;if(r){chrome.storage.sync.get("target_rule",function(r){if(l==r.target_rule||r.target_rule.length==0){e(null)}else{e(r.target_rule)}})}else{chrome.storage.local.get("target_rule",function(r){if(l==r.target_rule||r.target_rule.length==0){e(null)}else{e(r.target_rule)}})}}function g(e,r,l){l=typeof l!=="undefined"?l:false;if(l){chrome.storage.sync.set({target_rule:e},function(){r(true)})}else{chrome.storage.local.set({target_rule:e},function(){r(true)})}}var w={crawler_rule_query_by_id:t,crawler_rule_query_by_url:u,crawler_rule_query_all:c,crawler_rule_query_count:o,crawler_rule_new:a,crawler_rule_update:f,crawler_rule_delete:s,crawler_rule_clear:i,target_rule_query:_,target_rule_new:g,validate:n};var d={};d.api=w;e.cAstConfig=d})(window,document);